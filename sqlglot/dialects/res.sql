SELECT CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) AS `c0`, CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) AS `c1` FROM (SELECT T339.`S_DATE`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` GROUP BY `c0`, `c1` ORDER BY CASE WHEN `c0` IS NULL THEN 1 ELSE 0 END, `c0` ASC, CASE WHEN `c1` IS NULL THEN 1 ELSE 0 END, `c1` ASC;
SELECT `fact_union_all`.`viewId` AS `c0`, SUM(`fact_union_all`.`vat_tax_payable`) AS `m0`, SUM(`fact_union_all`.`sale_income`) AS `m1` FROM (SELECT T339.`S_DATE`, T339.`vat_tax_payable`, T339.`sale_income`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` WHERE (`fact_union_all`.`viewId` = 'COMBINEDQUERY30' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY31') AND CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-11' GROUP BY `c0`;
SELECT `fact_union_all`.`viewId` AS `c0`, SUM(`fact_union_all`.`all_tax_payable`) AS `m0`, SUM(`fact_union_all`.`sale_income`) AS `m1` FROM (SELECT T339.`S_DATE`, T339.`all_tax_payable`, T339.`sale_income`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` WHERE (`fact_union_all`.`viewId` = 'COMBINEDQUERY30' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY31') AND (CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-11' AND CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2021') GROUP BY `c0`;
SELECT `fact_union_all`.`viewId` AS `c0`, SUM(`fact_union_all`.`total_cost`) AS `m0` FROM (SELECT T339.`S_DATE`, T339.`total_cost`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` WHERE `fact_union_all`.`viewId` = 'COMBINEDQUERY30' AND (CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-11' AND CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2021') GROUP BY `c0`;
SELECT `fact_union_all`.`viewId` AS `c0`, SUM(`fact_union_all`.`total_assets`) AS `m0`, SUM(`fact_union_all`.`total_liabilities`) AS `m1` FROM (SELECT T339.`S_DATE`, T339.`total_assets`, T339.`total_liabilities`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` WHERE `fact_union_all`.`viewId` = 'COMBINEDQUERY30' AND CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-11' GROUP BY `c0`;
SELECT CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) AS `c0`, CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) AS `c1` FROM (SELECT T339.`S_DATE`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` GROUP BY `c0`, `c1` ORDER BY CASE WHEN `c0` IS NULL THEN 1 ELSE 0 END, `c0` ASC, CASE WHEN `c1` IS NULL THEN 1 ELSE 0 END, `c1` ASC;
SELECT NULL AS `c0`, CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) AS `c1`, NULL AS `c2`, CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) AS `c3`, NULL AS `c4` FROM (SELECT T339.`S_DATE`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` GROUP BY `c1`, `c3` ORDER BY CASE WHEN `c1` IS NULL THEN 1 ELSE 0 END, `c1` ASC, CASE WHEN `c3` IS NULL THEN 1 ELSE 0 END, `c3` ASC;
SELECT `fact_union_all`.`shiyebu_tab_qiehuan` AS `c0`, `fact_union_all`.`viewId` AS `c1`, COUNT(`fact_union_all`.`viewId`) AS `m0` FROM (SELECT T339.`shiyebu_tab_qiehuan`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` WHERE ((`fact_union_all`.`shiyebu_tab_qiehuan` = 'OTC大客户' OR `fact_union_all`.`shiyebu_tab_qiehuan` = '基层医疗' OR `fact_union_all`.`shiyebu_tab_qiehuan` = '处方药') OR `fact_union_all`.`shiyebu_tab_qiehuan` IS NULL) AND `fact_union_all`.`viewId` = 'COMBINEDQUERY2' GROUP BY `c0`, `c1`;
SELECT CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) AS `c0`, `fact_union_all`.`viewId` AS `c1`, COUNT(`fact_union_all`.`viewId`) AS `m0` FROM (SELECT T339.`S_DATE`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` WHERE CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-11' AND (`fact_union_all`.`viewId` = 'COMBINEDQUERY14' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY17') GROUP BY `c0`, `c1`;
SELECT CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) AS `c0`, `fact_union_all`.`viewId` AS `c1`, COUNT(`fact_union_all`.`viewId`) AS `m0` FROM (SELECT T339.`S_DATE`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` WHERE CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-11' AND (`fact_union_all`.`viewId` = 'COMBINEDQUERY17' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY30' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY31') GROUP BY `c0`, `c1`;
SELECT CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) AS `c0`, `fact_union_all`.`viewId` AS `c1`, COUNT(`fact_union_all`.`viewId`) AS `m0` FROM (SELECT T339.`S_DATE`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` WHERE CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-11' AND (`fact_union_all`.`viewId` = 'COMBINEDQUERY13' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY17') GROUP BY `c0`, `c1`;
SELECT CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) AS `c0`, `fact_union_all`.`viewId` AS `c1`, COUNT(`fact_union_all`.`viewId`) AS `m0` FROM (SELECT T339.`S_DATE`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` WHERE CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-11' AND (`fact_union_all`.`viewId` = 'COMBINEDQUERY13' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY17') GROUP BY `c0`, `c1`;
SELECT CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) AS `c0`, `fact_union_all`.`viewId` AS `c1`, COUNT(`fact_union_all`.`viewId`) AS `m0` FROM (SELECT T339.`S_DATE`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` WHERE CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-11' AND (`fact_union_all`.`viewId` = 'COMBINEDQUERY17' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY36') GROUP BY `c0`, `c1`;
SELECT CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) AS `c0`, `fact_union_all`.`viewId` AS `c1`, COUNT(`fact_union_all`.`viewId`) AS `m0` FROM (SELECT T339.`S_DATE`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` WHERE CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-11' AND (`fact_union_all`.`viewId` = 'COMBINEDQUERY17' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY31') GROUP BY `c0`, `c1`;
SELECT CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) AS `c0` FROM (SELECT T339.`S_DATE`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` GROUP BY `c0` ORDER BY CASE WHEN `c0` IS NULL THEN 1 ELSE 0 END, `c0` ASC;
SELECT CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) AS `c0`, `fact_union_all`.`viewId` AS `c1`, SUM(`fact_union_all`.`cost_target`) AS `m0` FROM (SELECT T339.`S_DATE`, T339.`cost_target`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` WHERE (CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-01' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-02' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-03' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-04' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-05' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-06' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-07' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-08' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-09' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-10' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-11') AND `fact_union_all`.`viewId` = 'COMBINEDQUERY14' GROUP BY `c0`, `c1`;
SELECT `fact_union_all`.`week` AS `c0`, `fact_union_all`.`viewId` AS `c1`, COUNT(`fact_union_all`.`viewId`) AS `m0` FROM (SELECT T339.`week`, T339.`S_DATE`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` WHERE ((`fact_union_all`.`week` = '1周' OR `fact_union_all`.`week` = '2周' OR `fact_union_all`.`week` = '3周' OR `fact_union_all`.`week` = '4周') OR `fact_union_all`.`week` IS NULL) AND `fact_union_all`.`viewId` = 'COMBINEDQUERY29' AND (CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-11' AND CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2021') GROUP BY `c0`, `c1`;
SELECT CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) AS `c0`, `fact_union_all`.`viewId` AS `c1`, COUNT(`fact_union_all`.`viewId`) AS `m0` FROM (SELECT T339.`S_DATE`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` WHERE (CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-01' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-02' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-03' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-04' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-05' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-06' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-07' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-08' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-09' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-10' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-11' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-12') AND (`fact_union_all`.`viewId` = 'COMBINEDQUERY15' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY17') GROUP BY `c0`, `c1`;
SELECT CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) AS `c0`, `fact_union_all`.`viewId` AS `c1`, SUM(`fact_union_all`.`sales_quota`) AS `m0` FROM (SELECT T339.`S_DATE`, T339.`sales_quota`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` WHERE (CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-01' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-02' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-03' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-04' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-05' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-06' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-07' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-08' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-09' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-10' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-11' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-01' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-02' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-03' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-04' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-05' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-06' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-07' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-08' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-09' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-10' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-11') AND `fact_union_all`.`viewId` = 'COMBINEDQUERY13' GROUP BY `c0`, `c1`;
SELECT CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) AS `c0`, `fact_union_all`.`viewId` AS `c1`, SUM(`fact_union_all`.`all_tax_payable`) AS `m0` FROM (SELECT T339.`S_DATE`, T339.`all_tax_payable`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` WHERE (CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-01' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-02' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-03' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-04' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-05' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-06' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-07' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-08' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-09' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-10' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-11' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-01' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-02' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-03' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-04' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-05' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-06' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-07' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-08' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-09' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-10' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-11') AND `fact_union_all`.`viewId` = 'COMBINEDQUERY31' GROUP BY `c0`, `c1`;
SELECT CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) AS `c0`, `fact_union_all`.`viewId` AS `c1`, SUM(`fact_union_all`.`cost_target`) AS `m0` FROM (SELECT T339.`S_DATE`, T339.`cost_target`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` WHERE (CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-01' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-02' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-03' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-04' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-05' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-06' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-07' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-08' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-09' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-10' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-11' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-01' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-02' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-03' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-04' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-05' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-06' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-07' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-08' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-09' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-10' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-11') AND `fact_union_all`.`viewId` = 'COMBINEDQUERY14' GROUP BY `c0`, `c1`;
SELECT CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) AS `c0`, `fact_union_all`.`viewId` AS `c1`, SUM(`fact_union_all`.`sales_amount`) AS `m0` FROM (SELECT T339.`S_DATE`, T339.`sales_amount`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` WHERE (CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-01' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-02' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-03' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-04' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-05' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-06' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-07' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-08' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-09' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-10' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-11' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-01' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-02' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-03' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-04' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-05' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-06' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-07' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-08' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-09' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-10' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-11') AND `fact_union_all`.`viewId` = 'COMBINEDQUERY13' GROUP BY `c0`, `c1`;
SELECT CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) AS `c0`, `fact_union_all`.`viewId` AS `c1`, SUM(`fact_union_all`.`amount_off`) AS `m0` FROM (SELECT T339.`S_DATE`, T339.`amount_off`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` WHERE (CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-01' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-02' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-03' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-04' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-05' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-06' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-07' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-08' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-09' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-10' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-11' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-01' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-02' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-03' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-04' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-05' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-06' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-07' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-08' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-09' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-10' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-11') AND `fact_union_all`.`viewId` = 'COMBINEDQUERY36' GROUP BY `c0`, `c1`;
SELECT CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) AS `c0`, `fact_union_all`.`viewId` AS `c1`, SUM(`fact_union_all`.`all_tax_payable`) AS `m0`, SUM(`fact_union_all`.`sale_income`) AS `m1` FROM (SELECT T339.`S_DATE`, T339.`all_tax_payable`, T339.`sale_income`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` WHERE (CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-11' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-11') AND (`fact_union_all`.`viewId` = 'COMBINEDQUERY30' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY31') GROUP BY `c0`, `c1`;
SELECT CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) AS `c0`, `fact_union_all`.`viewId` AS `c1`, COUNT(`fact_union_all`.`viewId`) AS `m0` FROM (SELECT T339.`S_DATE`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` WHERE (CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-01' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-02' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-03' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-04' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-05' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-06' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-07' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-08' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-09' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-10' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-11' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-12') AND (`fact_union_all`.`viewId` = 'COMBINEDQUERY15' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY17') GROUP BY `c0`, `c1`;
SELECT CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) AS `c0`, `fact_union_all`.`viewId` AS `c1`, COUNT(`fact_union_all`.`viewId`) AS `m0` FROM (SELECT T339.`S_DATE`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` WHERE (CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-01' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-02' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-03' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-04' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-05' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-06' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-07' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-08' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-09' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-10' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-11' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-12') AND (`fact_union_all`.`viewId` = 'COMBINEDQUERY15' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY17') GROUP BY `c0`, `c1`;
SELECT CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) AS `c0`, `fact_union_all`.`viewId` AS `c1`, COUNT(`fact_union_all`.`viewId`) AS `m0` FROM (SELECT T339.`S_DATE`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` WHERE (CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-01' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-02' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-03' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-04' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-05' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-06' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-07' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-08' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-09' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-10' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-11' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-12') AND (`fact_union_all`.`viewId` = 'COMBINEDQUERY15' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY17') GROUP BY `c0`, `c1`;
SELECT CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) AS `c0`, `fact_union_all`.`viewId` AS `c1`, SUM(`fact_union_all`.`total_profit`) AS `m0`, SUM(`fact_union_all`.`business_income`) AS `m1`, SUM(`fact_union_all`.`total_profit`) AS `m2` FROM (SELECT T339.`S_DATE`, T339.`total_profit`, T339.`business_income`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` WHERE (CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-01' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-02' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-03' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-04' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-05' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-06' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-07' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-08' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-09' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-10' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-11' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-12' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-01' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-02' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-03' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-04' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-05' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-06' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-07' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-08' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-09' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-10' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-11' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-12') AND `fact_union_all`.`viewId` = 'COMBINEDQUERY15' GROUP BY `c0`, `c1`;
SELECT CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) AS `c0`, `fact_union_all`.`viewId` AS `c1`, COUNT(`fact_union_all`.`viewId`) AS `m0` FROM (SELECT T339.`S_DATE`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` WHERE (CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-01' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-02' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-03' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-04' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-05' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-06' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-07' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-08' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-09' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-10' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-11' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-12') AND (`fact_union_all`.`viewId` = 'COMBINEDQUERY10' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY13' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY14' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY16' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY17' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY36' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY38' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY7') GROUP BY `c0`, `c1`;
SELECT CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) AS `c0`, `fact_union_all`.`viewId` AS `c1`, COUNT(`fact_union_all`.`viewId`) AS `m0` FROM (SELECT T339.`S_DATE`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` WHERE (CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-01' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-02' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-03' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-04' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-05' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-06' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-07' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-08' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-09' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-10' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-11' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-12') AND (`fact_union_all`.`viewId` = 'COMBINEDQUERY10' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY13' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY14' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY16' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY17' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY36' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY38' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY7') GROUP BY `c0`, `c1`;
SELECT CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) AS `c0`, `fact_union_all`.`viewId` AS `c1`, COUNT(`fact_union_all`.`viewId`) AS `m0` FROM (SELECT T339.`S_DATE`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` WHERE (CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-01' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-02' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-03' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-04' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-05' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-06' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-07' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-08' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-09' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-10' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-11' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-12') AND (`fact_union_all`.`viewId` = 'COMBINEDQUERY10' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY13' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY14' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY16' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY17' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY36' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY38' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY7') GROUP BY `c0`, `c1`;
SELECT CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) AS `c0`, `fact_union_all`.`viewId` AS `c1`, COUNT(`fact_union_all`.`viewId`) AS `m0` FROM (SELECT T339.`S_DATE`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` WHERE (CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-01' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-02' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-03' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-04' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-05' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-06' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-07' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-08' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-09' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-10' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-11' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-12') AND (`fact_union_all`.`viewId` = 'COMBINEDQUERY10' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY13' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY14' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY16' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY17' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY36' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY38' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY7') GROUP BY `c0`, `c1`;
SELECT CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) AS `c0`, `fact_union_all`.`nianlingqujian` AS `c1`, `fact_union_all`.`viewId` AS `c2`, COUNT(`fact_union_all`.`viewId`) AS `m0` FROM (SELECT T339.`S_DATE`, T339.`nianlingqujian`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` WHERE CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-11' AND ((`fact_union_all`.`nianlingqujian` = '20-25' OR `fact_union_all`.`nianlingqujian` = '26-30' OR `fact_union_all`.`nianlingqujian` = '31-45' OR `fact_union_all`.`nianlingqujian` = '46-50' OR `fact_union_all`.`nianlingqujian` = '51-65' OR `fact_union_all`.`nianlingqujian` = '66+') OR `fact_union_all`.`nianlingqujian` IS NULL) AND `fact_union_all`.`viewId` = 'COMBINEDQUERY27' GROUP BY `c0`, `c1`, `c2`;
SELECT CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) AS `c0`, `fact_union_all`.`viewId` AS `c1`, COUNT(`fact_union_all`.`viewId`) AS `m0` FROM (SELECT T339.`S_DATE`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` WHERE (CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-01' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-02' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-03' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-04' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-05' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-06' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-07' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-08' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-09' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-10' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-11' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-12') AND (`fact_union_all`.`viewId` = 'COMBINEDQUERY13' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY17') GROUP BY `c0`, `c1`;
SELECT CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) AS `c0`, `fact_union_all`.`A_dept_name` AS `c1`, `fact_union_all`.`viewId` AS `c2`, COUNT(`fact_union_all`.`viewId`) AS `m0` FROM (SELECT T339.`S_DATE`, T339.`A_dept_name`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` WHERE (CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-01' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-02' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-03' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-04' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-05' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-06' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-07' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-08' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-09' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-10' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-11' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-12') AND `fact_union_all`.`A_dept_name` = '营销中心' AND `fact_union_all`.`viewId` = 'COMBINEDQUERY27' GROUP BY `c0`, `c1`, `c2`;
SELECT CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) AS `c0`, `fact_union_all`.`viewId` AS `c1`, COUNT(`fact_union_all`.`viewId`) AS `m0` FROM (SELECT T339.`S_DATE`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` WHERE CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-11' AND `fact_union_all`.`viewId` = 'COMBINEDQUERY17' GROUP BY `c0`, `c1`;
SELECT CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) AS `c0`, `fact_union_all`.`viewId` AS `c1`, SUM(`fact_union_all`.`total_profit`) AS `m0`, SUM(`fact_union_all`.`business_income`) AS `m1`, SUM(`fact_union_all`.`total_profit`) AS `m2` FROM (SELECT T339.`S_DATE`, T339.`total_profit`, T339.`business_income`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` WHERE (CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-01' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-02' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-03' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-04' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-05' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-06' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-07' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-08' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-09' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-10' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-11' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-12' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-01' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-02' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-03' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-04' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-05' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-06' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-07' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-08' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-09' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-10' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-11' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-12') AND `fact_union_all`.`viewId` = 'COMBINEDQUERY15' GROUP BY `c0`, `c1`;
SELECT CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) AS `c0`, CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) AS `c1` FROM (SELECT T339.`S_DATE`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` WHERE (`fact_union_all`.`viewId` = 'COMBINEDQUERY30') GROUP BY `c0`, `c1` ORDER BY CASE WHEN `c0` IS NULL THEN 1 ELSE 0 END, `c0` ASC, CASE WHEN `c1` IS NULL THEN 1 ELSE 0 END, `c1` ASC;
SELECT CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) AS `c0`, `fact_union_all`.`viewId` AS `c1`, SUM(`fact_union_all`.`total_profit`) AS `m0`, SUM(`fact_union_all`.`business_income`) AS `m1`, SUM(`fact_union_all`.`total_profit`) AS `m2` FROM (SELECT T339.`S_DATE`, T339.`total_profit`, T339.`business_income`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` WHERE (CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-01' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-02' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-03' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-04' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-05' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-06' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-07' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-08' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-09' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-10' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-11' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-12' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-01' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-02' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-03' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-04' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-05' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-06' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-07' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-08' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-09' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-10' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-11' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-12') AND `fact_union_all`.`viewId` = 'COMBINEDQUERY15' GROUP BY `c0`, `c1`;
SELECT CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) AS `c0`, `fact_union_all`.`viewId` AS `c1`, COUNT(`fact_union_all`.`viewId`) AS `m0` FROM (SELECT T339.`S_DATE`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` WHERE ((CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2000' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2001' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2002' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2003' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2004' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2005' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2006' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2007' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2008' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2009' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2010' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2011' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2012' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2013' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2014' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2015' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2016' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2017' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2018' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2019' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2020' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2021' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2022' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2023' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2024' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2025' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2026' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2027' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2028' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2029') OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) IS NULL) AND `fact_union_all`.`viewId` = 'COMBINEDQUERY17' GROUP BY `c0`, `c1`;
SELECT CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) AS `c0`, `fact_union_all`.`A_dept_name` AS `c1`, `fact_union_all`.`viewId` AS `c2`, COUNT(`fact_union_all`.`viewId`) AS `m0`, SUM(`fact_union_all`.`all_num2`) AS `m1` FROM (SELECT T339.`S_DATE`, T339.`A_dept_name`, T339.`all_num2`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` WHERE CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-11' AND ((`fact_union_all`.`A_dept_name` = '人事行政部' OR `fact_union_all`.`A_dept_name` = '人力资源部' OR `fact_union_all`.`A_dept_name` = '仓库' OR `fact_union_all`.`A_dept_name` = '供应链事业部' OR `fact_union_all`.`A_dept_name` = '储运管理部' OR `fact_union_all`.`A_dept_name` = '办公室' OR `fact_union_all`.`A_dept_name` = '山东京御堂管理班子' OR `fact_union_all`.`A_dept_name` = '工程技术中心' OR `fact_union_all`.`A_dept_name` = '总经办' OR `fact_union_all`.`A_dept_name` = '技术创新中心' OR `fact_union_all`.`A_dept_name` = '江西井冈山天朴药物研究院' OR `fact_union_all`.`A_dept_name` = '生产中心' OR `fact_union_all`.`A_dept_name` = '生产管理部' OR `fact_union_all`.`A_dept_name` = '生产部' OR `fact_union_all`.`A_dept_name` = '药物警戒部' OR `fact_union_all`.`A_dept_name` = '营销中心' OR `fact_union_all`.`A_dept_name` = '董事会办公室' OR `fact_union_all`.`A_dept_name` = '设备动力部' OR `fact_union_all`.`A_dept_name` = '财务管理部' OR `fact_union_all`.`A_dept_name` = '财务部' OR `fact_union_all`.`A_dept_name` = '质量中心' OR `fact_union_all`.`A_dept_name` = '质量管理部' OR `fact_union_all`.`A_dept_name` = '质量部' OR `fact_union_all`.`A_dept_name` = '采购部' OR `fact_union_all`.`A_dept_name` = '销售部') OR `fact_union_all`.`A_dept_name` IS NULL) AND `fact_union_all`.`viewId` = 'COMBINEDQUERY27' GROUP BY `c0`, `c1`, `c2`;
SELECT CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) AS `c0`, `fact_union_all`.`viewId` AS `c1`, SUM(`fact_union_all`.`amount_off`) AS `m0` FROM (SELECT T339.`S_DATE`, T339.`amount_off`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` WHERE (CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-01' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-02' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-03' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-04' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-05' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-06' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-07' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-08' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-09' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-10' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-11') AND `fact_union_all`.`viewId` = 'COMBINEDQUERY36' GROUP BY `c0`, `c1`;
SELECT CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) AS `c0`, `fact_union_all`.`viewId` AS `c1`, SUM(`fact_union_all`.`sales_quota`) AS `m0` FROM (SELECT T339.`S_DATE`, T339.`sales_quota`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` WHERE (CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-01' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-02' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-03' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-04' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-05' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-06' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-07' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-08' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-09' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-10' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-11') AND `fact_union_all`.`viewId` = 'COMBINEDQUERY13' GROUP BY `c0`, `c1`;
SELECT CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) AS `c0`, `fact_union_all`.`viewId` AS `c1`, SUM(`fact_union_all`.`sales_amount`) AS `m0` FROM (SELECT T339.`S_DATE`, T339.`sales_amount`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` WHERE (CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-01' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-02' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-03' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-04' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-05' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-06' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-07' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-08' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-09' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-10' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-11') AND `fact_union_all`.`viewId` = 'COMBINEDQUERY13' GROUP BY `c0`, `c1`;
SELECT CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) AS `c0`, `fact_union_all`.`viewId` AS `c1`, SUM(`fact_union_all`.`total_profit`) AS `m0`, SUM(`fact_union_all`.`business_income`) AS `m1`, SUM(`fact_union_all`.`total_profit`) AS `m2` FROM (SELECT T339.`S_DATE`, T339.`total_profit`, T339.`business_income`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` WHERE (CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-01' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-02' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-03' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-04' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-05' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-06' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-07' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-08' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-09' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-10' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-11' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-12' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-01' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-02' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-03' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-04' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-05' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-06' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-07' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-08' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-09' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-10' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-11' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-12') AND `fact_union_all`.`viewId` = 'COMBINEDQUERY15' GROUP BY `c0`, `c1`;
SELECT CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) AS `c0`, COUNT(`fact_union_all`.`viewId`) AS `m0` FROM (SELECT T339.`S_DATE`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` WHERE (CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2000' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2001' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2002' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2003' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2004' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2005' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2006' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2007' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2008' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2009' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2010' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2011' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2012' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2013' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2014' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2015' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2016' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2017' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2018' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2019' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2020' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2021' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2022' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2023' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2024' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2025' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2026' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2027' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2028' OR CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2029') GROUP BY `c0`;
SELECT CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) AS `c0`, `fact_union_all`.`nianlingqujian` AS `c1`, `fact_union_all`.`viewId` AS `c2`, SUM(`fact_union_all`.`woman_num`) AS `m0`, SUM(`fact_union_all`.`man_num2`) AS `m1` FROM (SELECT T339.`S_DATE`, T339.`nianlingqujian`, T339.`woman_num`, T339.`man_num2`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` WHERE CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-11' AND (`fact_union_all`.`nianlingqujian` = '20-25' OR `fact_union_all`.`nianlingqujian` = '26-30' OR `fact_union_all`.`nianlingqujian` = '31-45' OR `fact_union_all`.`nianlingqujian` = '46-50' OR `fact_union_all`.`nianlingqujian` = '51-65' OR `fact_union_all`.`nianlingqujian` = '66+') AND `fact_union_all`.`viewId` = 'COMBINEDQUERY27' GROUP BY `c0`, `c1`, `c2`;
SELECT CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) AS `c0`, `fact_union_all`.`viewId` AS `c1`, COUNT(`fact_union_all`.`viewId`) AS `m0` FROM (SELECT T339.`S_DATE`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` WHERE (CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-01' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-02' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-03' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-04' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-05' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-06' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-07' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-08' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-09' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-10' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-11' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-12') AND (`fact_union_all`.`viewId` = 'COMBINEDQUERY17' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY30') GROUP BY `c0`, `c1`;
SELECT CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) AS `c0`, `fact_union_all`.`viewId` AS `c1`, SUM(`fact_union_all`.`sales_quota`) AS `m0` FROM (SELECT T339.`S_DATE`, T339.`sales_quota`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` WHERE (CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-01' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-02' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-03' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-04' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-05' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-06' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-07' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-08' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-09' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-10' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-11' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-12' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-01' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-02' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-03' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-04' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-05' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-06' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-07' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-08' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-09' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-10' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-11' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-12') AND `fact_union_all`.`viewId` = 'COMBINEDQUERY13' GROUP BY `c0`, `c1`;
SELECT CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) AS `c0`, `fact_union_all`.`A_dept_name` AS `c1`, `fact_union_all`.`viewId` AS `c2`, SUM(`fact_union_all`.`all_num2`) AS `m0` FROM (SELECT T339.`S_DATE`, T339.`A_dept_name`, T339.`all_num2`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` WHERE (CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-01' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-02' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-03' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-04' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-05' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-06' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-07' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-08' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-09' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-10' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-11' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-12' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-01' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-02' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-03' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-04' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-05' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-06' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-07' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-08' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-09' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-10' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-11' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-12') AND `fact_union_all`.`A_dept_name` = '营销中心' AND `fact_union_all`.`viewId` = 'COMBINEDQUERY27' GROUP BY `c0`, `c1`, `c2`;
SELECT CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) AS `c0`, `fact_union_all`.`viewId` AS `c1`, COUNT(`fact_union_all`.`viewId`) AS `m0` FROM (SELECT T339.`S_DATE`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` WHERE (CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-01' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-02' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-03' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-04' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-05' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-06' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-07' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-08' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-09' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-10' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-11' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-12') AND `fact_union_all`.`viewId` = 'COMBINEDQUERY17' GROUP BY `c0`, `c1`;
SELECT CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) AS `c0`, COUNT(`fact_union_all`.`viewId`) AS `m0` FROM (SELECT T339.`S_DATE`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` WHERE (CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-01' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-02' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-03' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-04' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-05' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-06' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-07' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-08' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-09' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-10' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-11' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-12') GROUP BY `c0`;
SELECT CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) AS `c0`, `fact_union_all`.`viewId` AS `c1`, SUM(`fact_union_all`.`overdue_amount`) AS `m0`, SUM(`fact_union_all`.`new_add`) AS `m1`, SUM(`fact_union_all`.`sales_quota`) AS `m2`, SUM(`fact_union_all`.`death`) AS `m3`, SUM(`fact_union_all`.`cost_target`) AS `m4`, SUM(`fact_union_all`.`sales_quota_target2`) AS `m5`, SUM(`fact_union_all`.`survival`) AS `m6`, SUM(`fact_union_all`.`amount2`) AS `m7`, SUM(`fact_union_all`.`amount_off`) AS `m8`, AVG(`fact_union_all`.`jingjie`) AS `m9`, SUM(`fact_union_all`.`sales_quota`) AS `m10`, AVG(`fact_union_all`.`jingjie`) AS `m11` FROM (SELECT T339.`S_DATE`, T339.`overdue_amount`, T339.`new_add`, T339.`sales_quota`, T339.`death`, T339.`cost_target`, T339.`sales_quota_target2`, T339.`survival`, T339.`amount2`, T339.`amount_off`, T339.`jingjie`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` WHERE (CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-01' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-02' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-03' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-04' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-05' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-06' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-07' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-08' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-09' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-10' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-11' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-12' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-01' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-02' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-03' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-04' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-05' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-06' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-07' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-08' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-09' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-10' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-11' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-12') AND (`fact_union_all`.`viewId` = 'COMBINEDQUERY10' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY13' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY14' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY16' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY17' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY36' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY38' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY7') GROUP BY `c0`, `c1`;
SELECT CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) AS `c0`, `fact_union_all`.`viewId` AS `c1`, SUM(`fact_union_all`.`overdue_amount`) AS `m0`, SUM(`fact_union_all`.`new_add`) AS `m1`, SUM(`fact_union_all`.`sales_quota`) AS `m2`, SUM(`fact_union_all`.`death`) AS `m3`, SUM(`fact_union_all`.`cost_target`) AS `m4`, SUM(`fact_union_all`.`sales_quota_target2`) AS `m5`, SUM(`fact_union_all`.`survival`) AS `m6`, SUM(`fact_union_all`.`amount2`) AS `m7`, SUM(`fact_union_all`.`amount_off`) AS `m8`, AVG(`fact_union_all`.`jingjie`) AS `m9`, SUM(`fact_union_all`.`sales_quota`) AS `m10`, AVG(`fact_union_all`.`jingjie`) AS `m11` FROM (SELECT T339.`S_DATE`, T339.`overdue_amount`, T339.`new_add`, T339.`sales_quota`, T339.`death`, T339.`cost_target`, T339.`sales_quota_target2`, T339.`survival`, T339.`amount2`, T339.`amount_off`, T339.`jingjie`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` WHERE (CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-01' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-02' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-03' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-04' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-05' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-06' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-07' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-08' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-09' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-10' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-11' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-12' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-01' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-02' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-03' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-04' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-05' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-06' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-07' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-08' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-09' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-10' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-11' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-12') AND (`fact_union_all`.`viewId` = 'COMBINEDQUERY10' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY13' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY14' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY16' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY17' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY36' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY38' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY7') GROUP BY `c0`, `c1`;
SELECT CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) AS `c0`, `fact_union_all`.`viewId` AS `c1`, SUM(`fact_union_all`.`overdue_amount`) AS `m0`, SUM(`fact_union_all`.`new_add`) AS `m1`, SUM(`fact_union_all`.`sales_quota`) AS `m2`, SUM(`fact_union_all`.`death`) AS `m3`, SUM(`fact_union_all`.`cost_target`) AS `m4`, SUM(`fact_union_all`.`sales_quota_target2`) AS `m5`, SUM(`fact_union_all`.`survival`) AS `m6`, SUM(`fact_union_all`.`amount2`) AS `m7`, SUM(`fact_union_all`.`amount_off`) AS `m8`, AVG(`fact_union_all`.`jingjie`) AS `m9`, SUM(`fact_union_all`.`sales_quota`) AS `m10`, AVG(`fact_union_all`.`jingjie`) AS `m11` FROM (SELECT T339.`S_DATE`, T339.`overdue_amount`, T339.`new_add`, T339.`sales_quota`, T339.`death`, T339.`cost_target`, T339.`sales_quota_target2`, T339.`survival`, T339.`amount2`, T339.`amount_off`, T339.`jingjie`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` WHERE (CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-01' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-02' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-03' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-04' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-05' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-06' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-07' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-08' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-09' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-10' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-11' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-12' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-01' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-02' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-03' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-04' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-05' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-06' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-07' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-08' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-09' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-10' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-11' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-12') AND (`fact_union_all`.`viewId` = 'COMBINEDQUERY10' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY13' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY14' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY16' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY17' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY36' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY38' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY7') GROUP BY `c0`, `c1`;
SELECT CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) AS `c0`, `fact_union_all`.`viewId` AS `c1`, SUM(`fact_union_all`.`overdue_amount`) AS `m0`, SUM(`fact_union_all`.`new_add`) AS `m1`, SUM(`fact_union_all`.`sales_quota`) AS `m2`, SUM(`fact_union_all`.`death`) AS `m3`, SUM(`fact_union_all`.`cost_target`) AS `m4`, SUM(`fact_union_all`.`sales_quota_target2`) AS `m5`, SUM(`fact_union_all`.`survival`) AS `m6`, SUM(`fact_union_all`.`amount2`) AS `m7`, SUM(`fact_union_all`.`amount_off`) AS `m8`, AVG(`fact_union_all`.`jingjie`) AS `m9`, SUM(`fact_union_all`.`sales_quota`) AS `m10`, AVG(`fact_union_all`.`jingjie`) AS `m11` FROM (SELECT T339.`S_DATE`, T339.`overdue_amount`, T339.`new_add`, T339.`sales_quota`, T339.`death`, T339.`cost_target`, T339.`sales_quota_target2`, T339.`survival`, T339.`amount2`, T339.`amount_off`, T339.`jingjie`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` WHERE (CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-01' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-02' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-03' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-04' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-05' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-06' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-07' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-08' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-09' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-10' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-11' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2020-12' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-01' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-02' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-03' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-04' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-05' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-06' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-07' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-08' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-09' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-10' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-11' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-12') AND (`fact_union_all`.`viewId` = 'COMBINEDQUERY10' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY13' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY14' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY16' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY17' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY36' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY38' OR `fact_union_all`.`viewId` = 'COMBINEDQUERY7') GROUP BY `c0`, `c1`;
SELECT CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) AS `c0`, `fact_union_all`.`viewId` AS `c1`, SUM(`fact_union_all`.`net_profit`) AS `m0`, SUM(`fact_union_all`.`cash_flow`) AS `m1` FROM (SELECT T339.`S_DATE`, T339.`net_profit`, T339.`cash_flow`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` WHERE (CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-01' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-02' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-03' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-04' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-05' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-06' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-07' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-08' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-09' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-10' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-11' OR CONCAT(CONCAT(CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING), '-'), CASE WHEN MONTH(TO_DATE(`S_DATE`)) < 10 THEN CONCAT('0', CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING)) ELSE CAST(MONTH(TO_DATE(`S_DATE`)) AS STRING) END) = '2021-12') AND `fact_union_all`.`viewId` = 'COMBINEDQUERY30' GROUP BY `c0`, `c1`;
SELECT CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) AS `c0`, `fact_union_all`.`pingui` AS `c1`, COUNT(`fact_union_all`.`viewId`) AS `m0` FROM (SELECT T339.`S_DATE`, T339.`pingui`, T339.`divisionId`, T339.`area`, T339.`dept_id`, T339.`ID`, T339.`line_type`, T339.`dept_line`, T339.`dept_id5`, T339.`staff_id`, T339.`viewId` FROM `smartbimpp`.`Iff808081017d51cc51cce434017d5aeec35e7022` AS T339 /* RowPermission_start */ WHERE (((T339.`divisionId` IN (SELECT divison_code FROM dbo.dm_division_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY2' OR `viewId` = 'COMBINEDQUERY28' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY2', 'COMBINEDQUERY28', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18')) AND (((T339.`line_type` IN (SELECT dept_line FROM dbo.dm_invent_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY23' OR `viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY5' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY37' OR `viewId` = 'COMBINEDQUERY10' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY39' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY23', 'COMBINEDQUERY26', 'COMBINEDQUERY5', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY37', 'COMBINEDQUERY10', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY39', 'COMBINEDQUERY19')) AND (((T339.`ID` IN (SELECT area_code FROM dbo.dm_area_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY26' OR `viewId` = 'COMBINEDQUERY6' OR `viewId` = 'COMBINEDQUERY9' OR `viewId` = 'COMBINEDQUERY7' OR `viewId` = 'COMBINEDQUERY8' OR `viewId` = 'COMBINEDQUERY13' OR `viewId` = 'COMBINEDQUERY36' OR `viewId` = 'COMBINEDQUERY11' OR `viewId` = 'COMBINEDQUERY16' OR `viewId` = 'COMBINEDQUERY38' OR `viewId` = 'COMBINEDQUERY18' OR `viewId` = 'COMBINEDQUERY19') OR NOT `viewId` IN ('COMBINEDQUERY26', 'COMBINEDQUERY6', 'COMBINEDQUERY9', 'COMBINEDQUERY7', 'COMBINEDQUERY8', 'COMBINEDQUERY13', 'COMBINEDQUERY36', 'COMBINEDQUERY11', 'COMBINEDQUERY16', 'COMBINEDQUERY38', 'COMBINEDQUERY18', 'COMBINEDQUERY19')) AND (((T339.`dept_id5` IN (SELECT dept_id FROM dbo.dm_dep_authority WHERE staff_id = 'admin'))) AND (`viewId` = 'COMBINEDQUERY20' OR `viewId` = 'COMBINEDQUERY22' OR `viewId` = 'COMBINEDQUERY27' OR `viewId` = 'COMBINEDQUERY12' OR `viewId` = 'COMBINEDQUERY14' OR `viewId` = 'COMBINEDQUERY15' OR `viewId` = 'COMBINEDQUERY38') OR NOT `viewId` IN ('COMBINEDQUERY20', 'COMBINEDQUERY22', 'COMBINEDQUERY27', 'COMBINEDQUERY12', 'COMBINEDQUERY14', 'COMBINEDQUERY15', 'COMBINEDQUERY38')) /* RowPermission_end */) AS `fact_union_all` WHERE CAST(YEAR(TO_DATE(`S_DATE`)) AS STRING) = '2021' AND (`fact_union_all`.`pingui` = '乙肝扶正胶囊0.25g.24袋' OR `fact_union_all`.`pingui` = '九味羌活喷雾剂10ml*1瓶*200盒' OR `fact_union_all`.`pingui` = '九味羌活喷雾剂20ml*1瓶*200盒' OR `fact_union_all`.`pingui` = '九味羌活喷雾剂40ml*1瓶*200盒' OR `fact_union_all`.`pingui` = '乳酶生片0.15g.10' OR `fact_union_all`.`pingui` = '乳酶生片0.3g.18' OR `fact_union_all`.`pingui` = '乳酶生片0.3g.36' OR `fact_union_all`.`pingui` = '五加皮酒250ml*1瓶*30盒' OR `fact_union_all`.`pingui` = '人参天麻药酒250ml*1瓶*30盒' OR `fact_union_all`.`pingui` = '人参天麻药酒250ml*2瓶*10盒' OR `fact_union_all`.`pingui` = '人参天麻药酒500ml*1瓶*20盒' OR `fact_union_all`.`pingui` = '克林霉素磷酸酯凝胶10g/支×1支/盒×400盒/箱' OR `fact_union_all`.`pingui` = '克林霉素磷酸酯凝胶20g/支×1支/盒×300盒/箱' OR `fact_union_all`.`pingui` = '全杜仲胶囊0.48g*12s*200盒' OR `fact_union_all`.`pingui` = '全杜仲胶囊0.48g*12s*240盒' OR `fact_union_all`.`pingui` = '全杜仲胶囊0.48g*36' OR `fact_union_all`.`pingui` = '全杜仲胶囊0.48g.24' OR `fact_union_all`.`pingui` = '六味地黄片0.3g*24粒' OR `fact_union_all`.`pingui` = '六味地黄胶囊0.3g*120s*80盒' OR `fact_union_all`.`pingui` = '六味地黄胶囊0.3g*24s*300盒' OR `fact_union_all`.`pingui` = '六味地黄胶囊0.3g*48s*200盒' OR `fact_union_all`.`pingui` = '六味地黄胶囊0.3g*60s*120盒' OR `fact_union_all`.`pingui` = '六味地黄胶囊0.3g*72s*80盒' OR `fact_union_all`.`pingui` = '利胆排石片0.43g*12片*4板*200盒' OR `fact_union_all`.`pingui` = '利胆排石片0.43g.36' OR `fact_union_all`.`pingui` = '利胆排石片0.43g.96' OR `fact_union_all`.`pingui` = '前列舒乐胶囊0.4g*36s*300盒' OR `fact_union_all`.`pingui` = '前列舒乐胶囊0.4g*48s*200盒' OR `fact_union_all`.`pingui` = '十全大补酒250ml*1瓶*30盒' OR `fact_union_all`.`pingui` = '南板蓝根颗粒15g*9袋*120盒' OR `fact_union_all`.`pingui` = '南板蓝根颗粒（无糖型）5g.6袋' OR `fact_union_all`.`pingui` = '参茸三七酒250ml*1瓶*30盒' OR `fact_union_all`.`pingui` = '史国公药酒250g*1瓶*30盒' OR `fact_union_all`.`pingui` = '史国公药酒500g*1瓶*20盒' OR `fact_union_all`.`pingui` = '吡罗昔康软膏10g/支×1支/盒×400盒/箱' OR `fact_union_all`.`pingui` = '和络舒肝片0.42g*36片' OR `fact_union_all`.`pingui` = '和络舒肝片0.42g.60' OR `fact_union_all`.`pingui` = '和络舒肝片0.42g.72' OR `fact_union_all`.`pingui` = '喷昔洛韦乳膏10g/支×1支/盒×400盒/箱' OR `fact_union_all`.`pingui` = '四季草片0.42g*36片' OR `fact_union_all`.`pingui` = '壮元补身酒250ml*1瓶*30盒' OR `fact_union_all`.`pingui` = '复方紫荆皮水杨酸溶液20ml/瓶×1瓶/盒×200盒/箱' OR `fact_union_all`.`pingui` = '妇女痛经颗粒5g*10袋*180盒' OR `fact_union_all`.`pingui` = '妇女痛经颗粒5g*6袋*200盒' OR `fact_union_all`.`pingui` = '小儿感冒宁合剂100ml*1瓶*120盒' OR `fact_union_all`.`pingui` = '小儿感冒宁合剂10ml*6支*100盒' OR `fact_union_all`.`pingui` = '小儿感冒宁合剂120ml.1' OR `fact_union_all`.`pingui` = '小儿感冒宁合剂150ml*1瓶*80盒' OR `fact_union_all`.`pingui` = '小儿感冒颗粒12g*10袋*120盒' OR `fact_union_all`.`pingui` = '小儿感冒颗粒12g*6袋*200盒' OR `fact_union_all`.`pingui` = '小儿止咳糖浆100ml*1瓶*120盒' OR `fact_union_all`.`pingui` = '小儿止咳糖浆120ml*1瓶*120盒' OR `fact_union_all`.`pingui` = '小儿腹泻宁合剂100ml*1瓶*120盒' OR `fact_union_all`.`pingui` = '小儿腹泻宁合剂10ml*10' OR `fact_union_all`.`pingui` = '小儿腹泻宁合剂10ml*6支*100盒' OR `fact_union_all`.`pingui` = '小儿腹泻宁合剂120ml.1' OR `fact_union_all`.`pingui` = '山楂麦曲颗粒5g*6袋*200盒' OR `fact_union_all`.`pingui` = '山楂麦曲颗粒5g*9袋*120盒' OR `fact_union_all`.`pingui` = '开塞露（含山梨醇）20ml/支×1支/盒×72盒/箱' OR `fact_union_all`.`pingui` = '开塞露（含甘油）20ml/支×1支/盒×72盒/箱' OR `fact_union_all`.`pingui` = '心舒宁片0.3g.24s' OR `fact_union_all`.`pingui` = '感冒止咳糖浆100ml*1瓶*120盒' OR `fact_union_all`.`pingui` = '感冒止咳颗粒10g*10袋*120盒' OR `fact_union_all`.`pingui` = '感冒止咳颗粒10g*6袋*200盒' OR `fact_union_all`.`pingui` = '感冒炎咳灵颗粒10g*6袋*200盒' OR `fact_union_all`.`pingui` = '感冒炎咳灵颗粒10g*9袋*120盒' OR `fact_union_all`.`pingui` = '杏香兔耳风胶囊0.35g.36s' OR `fact_union_all`.`pingui` = '板蓝根颗粒10g.20袋' OR `fact_union_all`.`pingui` = '止痢颗粒7g*6袋*200盒' OR `fact_union_all`.`pingui` = '止痢颗粒7g.9袋' OR `fact_union_all`.`pingui` = '消炎灵胶囊0.4g*24s*300盒' OR `fact_union_all`.`pingui` = '消炎灵胶囊0.4g*36s*300盒' OR `fact_union_all`.`pingui` = '消肿痔疮胶囊0.3g*24S*300盒' OR `fact_union_all`.`pingui` = '消肿痔疮胶囊0.3g*36s*300盒' OR `fact_union_all`.`pingui` = '消肿痔疮胶囊0.3g*48粒' OR `fact_union_all`.`pingui` = '清热散结胶囊0.35g*48s*200盒' OR `fact_union_all`.`pingui` = '清热散结胶囊0.35g*60s*200盒' OR `fact_union_all`.`pingui` = '清热散结胶囊0.58g*12s*200盒' OR `fact_union_all`.`pingui` = '清热散结胶囊0.58g*24S' OR `fact_union_all`.`pingui` = '清热暗疮胶囊0.4g*20s*300盒' OR `fact_union_all`.`pingui` = '清热暗疮胶囊0.4g*24s*200盒' OR `fact_union_all`.`pingui` = '清热暗疮胶囊0.4g*36s*200盒' OR `fact_union_all`.`pingui` = '溃平宁胶囊0.35g*36粒' OR `fact_union_all`.`pingui` = '溃平宁胶囊0.35g.24s' OR `fact_union_all`.`pingui` = '独一味泡腾片1g*18片' OR `fact_union_all`.`pingui` = '独一味泡腾片1g*9片' OR `fact_union_all`.`pingui` = '生脉饮10ml*10支*60盒' OR `fact_union_all`.`pingui` = '甲紫溶液500ml/瓶×20瓶/箱' OR `fact_union_all`.`pingui` = '白蒲黄颗粒6g*9袋' OR `fact_union_all`.`pingui` = '益母草颗粒15g*10袋*120盒' OR `fact_union_all`.`pingui` = '益母草颗粒15g.9袋' OR `fact_union_all`.`pingui` = '知柏地黄片0.3g*24粒' OR `fact_union_all`.`pingui` = '知柏地黄片0.3g.48s' OR `fact_union_all`.`pingui` = '碘酊20ml/瓶×10瓶/盒×72盒/箱' OR `fact_union_all`.`pingui` = '祼花紫珠颗粒3g*5袋/盒' OR `fact_union_all`.`pingui` = '穿王消炎胶囊0.22g*24s*300盒' OR `fact_union_all`.`pingui` = '穿王消炎胶囊0.22g*36s*300盒' OR `fact_union_all`.`pingui` = '穿王消炎胶囊0.44g*12S*300盒' OR `fact_union_all`.`pingui` = '穿王消炎胶囊0.44g*24S*300盒' OR `fact_union_all`.`pingui` = '穿王消炎胶囊0.44g*36S*300盒' OR `fact_union_all`.`pingui` = '穿黄清热胶囊12s*2板*300盒' OR `fact_union_all`.`pingui` = '精制银翘解毒片0.26g.24' OR `fact_union_all`.`pingui` = '紫灯片0.54g*24片*300盒' OR `fact_union_all`.`pingui` = '红花逍遥片0.39g*12片*300盒' OR `fact_union_all`.`pingui` = '红花逍遥片0.39g*24片*300盒' OR `fact_union_all`.`pingui` = '红花逍遥片0.39g*36片*300盒' OR `fact_union_all`.`pingui` = '红花逍遥片0.39g*60片*200盒' OR `fact_union_all`.`pingui` = '维D2磷酸氢钙片复方60' OR `fact_union_all`.`pingui` = '联苯苄唑溶液1%*40ml/瓶/盒' OR `fact_union_all`.`pingui` = '联苯苄唑溶液10ml/瓶×1瓶/盒×120盒/箱' OR `fact_union_all`.`pingui` = '联苯苄唑溶液20ml/瓶×1瓶/盒×800盒/箱' OR `fact_union_all`.`pingui` = '联苯苄唑溶液25ml/瓶×1瓶/盒×120盒/箱' OR `fact_union_all`.`pingui` = '联苯苄唑溶液60ml/瓶×1瓶/盒×120盒/箱' OR `fact_union_all`.`pingui` = '肾康宁胶囊0.35g*24s*300盒' OR `fact_union_all`.`pingui` = '肾康宁胶囊0.35g*30' OR `fact_union_all`.`pingui` = '肾康宁胶囊0.35g*60s*200盒' OR `fact_union_all`.`pingui` = '胃膜素胶囊0.4g*12粒*6板*200盒' OR `fact_union_all`.`pingui` = '舒筋活络酒250ml*1瓶*16盒' OR `fact_union_all`.`pingui` = '舒筋活络酒250ml*1瓶*30盒' OR `fact_union_all`.`pingui` = '舒筋活络酒500ml*1瓶*20盒' OR `fact_union_all`.`pingui` = '芙蓉抗流感颗粒5g*9袋' OR `fact_union_all`.`pingui` = '苯扎溴铵溶液5%*500ml*20瓶/盒' OR `fact_union_all`.`pingui` = '莲芝消炎软胶囊0.4g*24s*300盒' OR `fact_union_all`.`pingui` = '葛山降脂颗粒4g*12片' OR `fact_union_all`.`pingui` = '葛山降脂颗粒4g*18片' OR `fact_union_all`.`pingui` = '葛山降脂颗粒4g*6袋*200盒' OR `fact_union_all`.`pingui` = '葛山降脂颗粒4g.9' OR `fact_union_all`.`pingui` = '藿香正气水10ml.3瓶' OR `fact_union_all`.`pingui` = '蛇胆陈皮散0.3g.6袋' OR `fact_union_all`.`pingui` = '血平片0.35g*24片*300盒' OR `fact_union_all`.`pingui` = '血平片0.35g*36片*300盒' OR `fact_union_all`.`pingui` = '血平片0.35g*48片*200盒' OR `fact_union_all`.`pingui` = '补中益气合剂10ml*10支*80盒' OR `fact_union_all`.`pingui` = '补中益气合剂10ml*18支*40盒' OR `fact_union_all`.`pingui` = '裸花紫珠颗粒3g.12s' OR `fact_union_all`.`pingui` = '裸花紫珠颗粒3g.15袋' OR `fact_union_all`.`pingui` = '裸花紫珠颗粒（无糖型）3g*6袋*300盒' OR `fact_union_all`.`pingui` = '裸花紫珠颗粒（无糖型）3g*9袋*200盒' OR `fact_union_all`.`pingui` = '西洋参胶囊0.5g*12s*300盒' OR `fact_union_all`.`pingui` = '西洋参胶囊0.5g*24s*300盒' OR `fact_union_all`.`pingui` = '跌打活血散3g*10瓶' OR `fact_union_all`.`pingui` = '重感灵胶囊0.25g*36s*300盒' OR `fact_union_all`.`pingui` = '重感灵胶囊0.5g*12片' OR `fact_union_all`.`pingui` = '重感灵胶囊0.5g*20s*300盒' OR `fact_union_all`.`pingui` = '重感灵胶囊0.5g*24s*300盒' OR `fact_union_all`.`pingui` = '风湿痛药酒250ml*1瓶*30盒' OR `fact_union_all`.`pingui` = '风湿痛药酒500ml*1瓶*20盒' OR `fact_union_all`.`pingui` = '鬼臼毒素酊3ml/瓶') GROUP BY `c0`, `c1`;
